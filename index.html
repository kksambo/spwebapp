<!DOCTYPE html>
<html>
    <head>
        <title>Service Hub</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <!-- Bootstrap CSS -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

        <style>
            html, body {
                margin: 0;
                padding: 0;
                height: 100%;
                width: 100%;
                overflow: hidden;
                background: url('images/hub.jpg');
                background-size: cover;
            }

            .container {
                display: flex;
                justify-content: space-between;
                align-items: center;
                height: 100vh;
                padding: 0 20px;
            }

            .left-section {
                max-width: 50%;
                color: white;
            }

            h1 {
                font-size: 2rem;
                font-family: Arial, sans-serif;
                font-weight: bold;
                color: blue;
            }

            p {
                font-size: 1.2rem;
                font-family: Arial, sans-serif;
                line-height: 1.6;
                margin-top: 20px;
                color: blue;
            }

            .right-section {
                max-width: 40%;
                padding: 20px;
                background-color: rgba(0, 0, 0, 0.5);
                border-radius: 10px;
                color: white;
            }

            .tabs {
                display: flex;
                justify-content: space-around;
                margin-bottom: 20px;
            }

            .tab-button {
                background-color: transparent;
                color: white;
                padding: 10px 20px;
                font-size: 1rem;
                border: none;
                cursor: pointer;
                position: relative;
                font-family: Arial, sans-serif;
            }

            .tab-button:hover {
                color: blue;
            }

            .tab-button.active {
                color: blue;
                font-weight: bold;
            }

            .tab-button.active::after {
                content: "";
                position: absolute;
                bottom: -5px;
                left: 0;
                width: 100%;
                height: 3px;
                background-color: blue;
            }

            .form-section {
                display: none;
            }

            input[type="text"], input[type="password"], input[type="email"], input[type="submit"], select {
                width: 100%;
                padding: 10px;
                margin: 10px 0;
                border-radius: 5px;
                border: none;
            }

            input[type="submit"] {
                background-color: blue;
                color: white;
                cursor: pointer;
            }

            input[type="submit"]:hover {
                background-color: #1E60A8;
            }

            .role-options label {
                margin-right: 15px;
            }

            label {
                font-size: 1rem;
                font-weight: bold;
                display: block;
                margin-bottom: 5px;
            }

            .navbar {
                background-color: rgba(0, 0, 0, 0.7) !important;
            }

            .navbar-brand, .nav-link {
                color: white !important;
            }

            .nav-link:hover {
                color: lightblue !important;
            }
        </style>
    </head>
    <body>

        <div class="container">
            <div class="left-section">
                <h1>Service Hub</h1>
                <p>Your one-stop platform offering a variety of services to cater to your needs. Whether you need cleaning, cooking, or painting etc, we have professionals ready to assist you. Explore and experience quality services at your convenience.</p>
            </div>

            <div class="right-section">
                <div class="tabs">
                    <button class="tab-button active" onclick="showSection('login', event)">Login</button>
                    <button class="tab-button" onclick="showSection('createAccount', event)">Create Account</button>
                    <button class="tab-button" onclick="showSection('forgotPassword', event)">Forgot Password</button>
                </div>

                <div class="form-section" id="login">
                    <h2>Login</h2>
                    <form action="" method="POST">
                        
                        <label for="username">Username:</label>
                        <input type="text" name="email" placeholder="email" required>

                        <label for="password">Password:</label>
                        <input type="password" name="password" placeholder="Password" required>
                        
                        <input type="submit" value="Login">
                    </form>
                </div>

                <div class="form-section" id="createAccount">
                    <h2>Create Account</h2>
                    <form action="" method="POST">
                        <label for="accountAs">Create Account as:</label>
                        <select id="accountAs" name="createRole" required>
                            <option value="client">Client</option>
                            <option value="serviceProvider">Service Provider</option>
                            <option value="administrator">administrator</option>
                        </select>
                        
                        <label for="name">Full Name:</label>
                        <input type="text" name="name" placeholder="Full Name" required>

                        <label for="email">Email Address:</label>
                        <input type="email" name="email" placeholder="example@gmail.com" required>

                        <label for="password">Password:</label>
                        <input type="password" name="password" placeholder="Password" required>

                        <label for="confirmPassword">Confirm Password:</label>
                        <input type="password" name="confirmPassword" placeholder="Confirm Password" required>

                        <label for="securityPhrase">Security Phrase</label>
                        <input type="text" name="securityPhrase" placeholder="securityPhrase" required>
                        
                        <input type="submit" value="Create Account">
                    </form>
                </div>

                <div class="form-section" id="forgotPassword">
                    <h2>Forgot Password</h2>
                    <form>
                        <div id="email">
                            <label for="email">Enter your email:</label>
                            <input type="email" name="email" placeholder="example@gmail.com" required>
                        </div>
                        <div id="secPhrase">
                            <label for="securityPhrase">Enter your security phrase:</label>
                            <input type="text" name="securityPhrase" placeholder="SECURITY PHRASE" required>
                        </div>

                        <div id="newPassword" >
                            <label for="newPassword">Enter new password</label>
                            <input type="password" name="newPassword" placeholder="password" required>
                        </div>
                        
                        <input type="submit" value="Reset Password">
                    </form>
                </div>
            </div>
        </div>

        <!-- Bootstrap JS Bundle (includes Popper) -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

        <script>
            function showSection(sectionId, event) {
                document.querySelectorAll('.form-section').forEach(section => section.style.display = 'none');
                document.getElementById(sectionId).style.display = 'block';
                document.querySelectorAll('.tab-button').forEach(button => button.classList.remove('active'));
                event.target.classList.add('active');
            }

            function toggleContactInput() {
                const contactType = document.getElementById('contactType').value;
                document.getElementById('emailInput').style.display = contactType === 'email' ? 'block' : 'none';
                document.getElementById('phoneInput').style.display = contactType === 'phone' ? 'block' : 'none';
            }

            document.addEventListener("DOMContentLoaded", function () {
                document.getElementById('login').style.display = 'block';
            });

          
    document.querySelector('#createAccount form').addEventListener('submit', async function (e) {
        e.preventDefault(); // Prevent regular form submission

        const formData = new FormData(this);
        console.log(formData);
        const data = Object.fromEntries(formData.entries());
        console.log(data);

        try {
            const response = await fetch('https://sp-09gc.onrender.com/api/create-user', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(data)
            });

            const result = await response.json();

            if (response.ok) {
                alert('Account created successfully!');
                // Optionally reset the form
                this.reset();
            } else {
                alert(`Error: ${result.message}`);
            }
        } catch (error) {
            console.error('Fetch error:', error);
            alert('Failed to connect to the server.');
        }
    });

    document.querySelector('#login form').addEventListener('submit', async function (e) {
        e.preventDefault(); // Prevent regular form submission

        const formData = new FormData(this);
        const data = Object.fromEntries(formData.entries());

        try {
            const response = await fetch('https://sp-09gc.onrender.com/api/login', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(data)
            });

            const result = await response.json();

            if (response.ok) {
                console.log(result);
                localStorage.setItem('name', JSON.stringify(result.user.name));
                localStorage.setItem('id', JSON.stringify(result.user.id));
                console.log(localStorage.getItem('name'));
                console.log(localStorage.getItem('id'));


               if(result.user.role === 'client') {
                    window.location.href = 'services.html';
                } else if (result.user.role === 'serviceProvider') {
                    window.location.href = 'serviceProviderProfile.html'; 
                } else if (result.user.role === 'administrator') {
                    window.location.href = 'adminView.html'; 
                }
             
                
                // Optionally reset the form
                this.reset();
            } else {
                alert(`Error: ${result.message}`);
            }
        } catch (error) {
            console.error('Fetch error:', error);
            alert('Failed to connect to the server.');
        }
    });







    document.querySelector('#forgotPassword form').addEventListener('submit', async function (e) {
        e.preventDefault(); // Prevent regular form submission

        const formData = new FormData(this);
        const data = Object.fromEntries(formData.entries());

        try {
            const response = await fetch('https://sp-09gc.onrender.com/api/reset-password', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(data)
            });

            const result = await response.json();

            if (response.ok) {
                console.log(result);

                this.reset();
            } else {
                alert(`Error: ${result.message}`);
            }
        } catch (error) {
            console.error('Fetch error:', error);
            alert('Failed to connect to the server.');
        }
    });





        </script>
    </body>
</html>
